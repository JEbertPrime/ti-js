var ti=function(t){var e={};function n(r){if(e[r])return e[r].exports;var u=e[r]={i:r,l:!1,exports:{}};return t[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var u in t)n.d(r,u,function(e){return t[e]}.bind(null,u));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";n.r(e),n.d(e,"ti",(function(){return r})),n.d(e,"lib",(function(){return u})),n.d(e,"SyntaxError",(function(){return o})),n.d(e,"NUMBER",(function(){return i})),n.d(e,"LIST",(function(){return a})),n.d(e,"STRING",(function(){return c})),n.d(e,"ANS",(function(){return l})),n.d(e,"GetKey",(function(){return s})),n.d(e,"VARIABLE",(function(){return f})),n.d(e,"STRINGVARIABLE",(function(){return p})),n.d(e,"LISTVARIABLE",(function(){return d})),n.d(e,"LISTINDEX",(function(){return m})),n.d(e,"BINARY",(function(){return v})),n.d(e,"UNARY",(function(){return h})),n.d(e,"EmptyStatement",(function(){return S})),n.d(e,"ValueStatement",(function(){return y})),n.d(e,"AssignmentStatement",(function(){return b})),n.d(e,"IfStatement",(function(){return g})),n.d(e,"ThenStatement",(function(){return E})),n.d(e,"ElseStatement",(function(){return L})),n.d(e,"ForLoop",(function(){return R})),n.d(e,"WhileLoop",(function(){return A})),n.d(e,"RepeatLoop",(function(){return I})),n.d(e,"EndStatement",(function(){return w})),n.d(e,"PauseStatement",(function(){return k})),n.d(e,"LabelStatement",(function(){return T})),n.d(e,"GotoStatement",(function(){return x})),n.d(e,"IncrementSkip",(function(){return N})),n.d(e,"DecrementSkip",(function(){return B})),n.d(e,"MenuStatement",(function(){return C})),n.d(e,"ProgramStatement",(function(){return G})),n.d(e,"ReturnStatement",(function(){return M})),n.d(e,"StopStatement",(function(){return D})),n.d(e,"DelVarStatement",(function(){return V})),n.d(e,"GraphStyleStatement",(function(){return U})),n.d(e,"OpenLibStatement",(function(){return P})),n.d(e,"ExecLibStatement",(function(){return O})),n.d(e,"Input",(function(){return F})),n.d(e,"Prompt",(function(){return H})),n.d(e,"Display",(function(){return Y})),n.d(e,"DispGraph",(function(){return j})),n.d(e,"DispTable",(function(){return W})),n.d(e,"Output",(function(){return $})),n.d(e,"ClrHome",(function(){return K})),n.d(e,"ClrTable",(function(){return X})),n.d(e,"GetCalc",(function(){return _})),n.d(e,"Get",(function(){return q})),n.d(e,"Send",(function(){return Q}));const r="ti",u="lib",o="SyntaxError",i="number",a="list",c="string",l="ans",s="GetKey",f="variable",p="stringVariable",d="listVariable",m="listIndex",v="binary",h="unary",S="empty",y="value",b="assign",g="IfStatement",E="ThenStatement",L="ElseStatement",R="ForLoop",A="WhileLoop",I="RepeatLoop",w="EndStatement",k="PauseStatement",T="LabelStatement",x="GotoStatement",N="IncrementSkip",B="DecrementSkip",C="MenuStatement",G="ProgramStatement",M="ReturnStatement",D="StopStatement",V="DelVarStatement",U="GraphStyleStatement",P="OpenLibStatement",O="ExecLibStatement",F="Input",H="Prompt",Y="display",j="DispGraph",W="DispTable",$="Output",K="ClrHome",X="ClrTable",_="GetCalc",q="Get",Q="Send"},function(t,e,n){"use strict";function r(t,e,n,u){this.message=t,this.expected=e,this.found=n,this.location=u,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(r,Error),r.buildMessage=function(t,e){var n={literal:function(t){return'"'+u(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description},not:function(t){return"not "+i(t.expected)}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function u(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function i(t){return n[t.type](t)}return"Expected "+function(t){var e,n,r=t.map(i);if(r.sort(),r.length>0){for(e=1,n=1;e<r.length;e++)r[e-1]!==r[e]&&(r[n]=r[e],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(t)+" but "+function(t){return t?'"'+u(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:r,parse:function(t,e){e=void 0!==e?e:{};var u,o={},i={Start:Ht},a=Ht,c=/^[A-Z]/,l=/^[A-Z0-9]/,s=/^[0-9]/,f=/^[1-6]/,p=/^[+\-]/,d=/^[^"]/,m={type:"any"},v=Mt([["A","Z"]],!1,!1),h=Mt([["A","Z"],["0","9"]],!1,!1),S=Mt([["0","9"]],!1,!1),y=Gt(")",!1),b=Gt("&theta",!1),g=Gt("Str",!1),E=Gt("&L",!1),L=Mt([["1","6"]],!1,!1),R=Gt("&list",!1),A=Gt("(",!1),I=Mt(["+","-"],!1,!1),w=Gt("&E",!1),k=Gt(".",!1),T=Mt(['"'],!0,!1),x=Gt('"',!1),N=Gt("Ans",!1),B=Gt("getKey",!1),C=Gt("{",!1),G=Gt("}",!1),M=Gt("&-",!1),D=Gt("*",!1),V=Gt("/",!1),U=Gt("+",!1),P=Gt("-",!1),O=Gt("=",!1),F=Gt("!=",!1),H=Gt(">=",!1),Y=Gt(">",!1),j=Gt("<=",!1),W=Gt("<",!1),$=Gt(",",!1),K=Gt("->",!1),X=Gt("If ",!1),_=Gt("Then",!1),q=Gt("Else",!1),Q=Gt("For(",!1),Z=Gt("While ",!1),z=Gt("Repeat ",!1),J=Gt("End",!1),tt=Gt("Pause",!1),et=Gt("Lbl ",!1),nt=Gt("Goto ",!1),rt=Gt("IS>(",!1),ut=Gt("DS<(",!1),ot=Gt("Menu(",!1),it=Gt("prgm",!1),at=Gt("Return",!1),ct=Gt("Stop",!1),lt=Gt("DelVar ",!1),st=Gt("GraphStyle(",!1),ft=Gt("OpenLib(",!1),pt=Gt("ExecLib(",!1),dt=Gt("Input ",!1),mt=Gt("Prompt ",!1),vt=Gt("Disp ",!1),ht=Gt("DispGraph",!1),St=Gt("DispTable",!1),yt=Gt("Output(",!1),bt=Gt("ClrHome",!1),gt=Gt("ClrTable",!1),Et=Gt("GetCalc(",!1),Lt=Gt("Get(",!1),Rt=Gt("Send(",!1),At=function(){return Ct()},It=function(t,e){return{type:Re.UNARY,operator:t,argument:e}},wt=function(t,e,n){return Ae.buildImplicitBinaryExpression(t,e,n)},kt=function(t,e){return Ae.buildBinaryExpression(t,e)},Tt=0,xt=0,Nt=[{line:1,column:1}],Bt=[];if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');a=i[e.startRule]}function Ct(){return t.substring(xt,Tt)}function Gt(t,e){return{type:"literal",text:t,ignoreCase:e}}function Mt(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function Dt(e){var n,r=Nt[e];if(r)return r;for(n=e-1;!Nt[n];)n--;for(r={line:(r=Nt[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Nt[e]=r,r}var Vt="string"==typeof e.filename&&e.filename.length>0;function Ut(t,n){var r={};Vt&&(r.filename=e.filename);var u=Dt(t);r.start={offset:t,line:u.line,column:u.column};var o=Dt(n);return r.end={offset:n,line:o.line,column:o.column},r}function Pt(){Bt.push({pos:Tt,variants:[]})}function Ot(t){var e=Bt[Bt.length-1];Tt<e.pos||(Tt>e.pos&&(e.pos=Tt,e.variants=[]),e.variants.push(t))}function Ft(t,e,n){return new r(r.buildMessage(t,e),t,e,n)}function Ht(){return function(){var e;(e=function(){var t,e,n;t=Tt,e=Tt,Pt(),n=Yt(),function(t){var e=Bt.pop(),n=Bt[Bt.length-1],r=e.variants;n.pos===e.pos&&(t&&(r=r.map((function(t){return"not"===t.type?t.expected:{type:"not",expected:t}}))),Array.prototype.push.apply(n.variants,r))}(!0),n===o?e=void 0:(Tt=e,e=o);e!==o&&(xt=t,e={type:Re.EmptyStatement});return t=e}())===o&&(e=function(){var e,n,r,u;e=Tt,(n=Ee())!==o?(!function(t){Ot(t)}(K),"->"===t.substr(Tt,2)?(r="->",Tt+=2):r=o,r!==o&&(u=ne())!==o?(xt=e,i=n,a=u,e={type:Re.AssignmentStatement,value:i,assignable:a}):(Tt=e,e=o)):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e;(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(X),"If "===t.substr(Tt,3)?(n="If ",Tt+=3):n=o;n!==o?((r=Ee())===o&&(r=null),(u=Kt())===o&&(u=null),xt=e,i=r,a=u,e={type:Re.IfStatement,value:i,extra:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(_),"Then"===t.substr(Tt,4)?(n="Then",Tt+=4):n=o;n!==o?((r=Kt())===o&&(r=null),xt=e,u=r,e={type:Re.ThenStatement,extra:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(q),"Else"===t.substr(Tt,4)?(n="Else",Tt+=4):n=o;n!==o?((r=Kt())===o&&(r=null),xt=e,u=r,e={type:Re.ElseStatement,extra:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n,r,u,i,a,c,l;e=Tt,function(t){Ot(t)}(Q),"For("===t.substr(Tt,4)?(n="For(",Tt+=4):n=o;n!==o?((r=te())===o&&(r=null),(u=Le())===o&&(u=null),(i=Le())===o&&(i=null),(a=Le())===o&&(a=null),(c=function(){var t,e,n;if(t=Tt,e=[],(n=Le())!==o)for(;n!==o;)e.push(n),n=Le();else e=o;e!==o&&(xt=t,e=!0);return t=e}())===o&&(c=null),Xt(),(l=Kt())===o&&(l=null),xt=e,s=r,f=u,p=i,d=a,m=c,v=l,e={type:Re.ForLoop,variable:s,start:f,end:p,step:d,args:m,extra:v}):(Tt=e,e=o);var s,f,p,d,m,v;return e}())===o&&(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(Z),"While "===t.substr(Tt,6)?(n="While ",Tt+=6):n=o;n!==o?((r=Ee())===o&&(r=null),(u=Kt())===o&&(u=null),xt=e,i=r,a=u,e={type:Re.WhileLoop,value:i,extra:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(z),"Repeat "===t.substr(Tt,7)?(n="Repeat ",Tt+=7):n=o;n!==o?((r=Ee())===o&&(r=null),(u=Kt())===o&&(u=null),xt=e,i=r,a=u,e={type:Re.RepeatLoop,value:i,extra:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(J),"End"===t.substr(Tt,3)?(n="End",Tt+=3):n=o;n!==o?((r=Kt())===o&&(r=null),xt=e,u=r,e={type:Re.EndStatement,extra:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(tt),"Pause"===t.substr(Tt,5)?(n="Pause",Tt+=5):n=o;n!==o&&(xt=e,n={type:Re.PauseStatement});return e=n}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(et),"Lbl "===t.substr(Tt,4)?(n="Lbl ",Tt+=4):n=o;n!==o&&(r=_t())!==o?(xt=e,e=function(t){return{type:Re.LabelStatement,location:t}}(r)):(Tt=e,e=o);return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(nt),"Goto "===t.substr(Tt,5)?(n="Goto ",Tt+=5):n=o;n!==o&&(r=_t())!==o?(xt=e,e=function(t){return{type:Re.GotoStatement,location:t}}(r)):(Tt=e,e=o);return e}())===o&&(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(rt),"IS>("===t.substr(Tt,4)?(n="IS>(",Tt+=4):n=o;n!==o?((r=te())===o&&(r=null),(u=Le())===o&&(u=null),Xt(),xt=e,i=r,a=u,e={type:Re.IncrementSkip,variable:i,end:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(ut),"DS<("===t.substr(Tt,4)?(n="DS<(",Tt+=4):n=o;n!==o?((r=te())===o&&(r=null),(u=Le())===o&&(u=null),Xt(),xt=e,i=r,a=u,e={type:Re.DecrementSkip,variable:i,end:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r,u,i,a,c,l,s,f=function(t){Ot(t)};e=Tt,f(ot),"Menu("===t.substr(Tt,5)?(n="Menu(",Tt+=5):n=o;if(n!==o){for((r=Ee())===o&&(r=null),u=[],i=Tt,f($),44===t.charCodeAt(Tt)?(a=",",Tt++):a=o,a!==o&&(c=ae())!==o?(f($),44===t.charCodeAt(Tt)?(l=",",Tt++):l=o,l!==o&&(s=_t())!==o?i=a=[a,c,l,s]:(Tt=i,i=o)):(Tt=i,i=o);i!==o;)u.push(i),i=Tt,f($),44===t.charCodeAt(Tt)?(a=",",Tt++):a=o,a!==o&&(c=ae())!==o?(f($),44===t.charCodeAt(Tt)?(l=",",Tt++):l=o,l!==o&&(s=_t())!==o?i=a=[a,c,l,s]:(Tt=i,i=o)):(Tt=i,i=o);i=Xt(),xt=e,e=function(t,e){return Ae.buildMenuStatement(t,e)}(r,u)}else Tt=e,e=o;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(it),"prgm"===t.substr(Tt,4)?(n="prgm",Tt+=4):n=o;n!==o&&(r=qt())!==o?(xt=e,u=r,e={type:Re.ProgramStatement,name:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(at),"Return"===t.substr(Tt,6)?(n="Return",Tt+=6):n=o;n!==o&&(xt=e,n={type:Re.ReturnStatement});return e=n}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(ct),"Stop"===t.substr(Tt,4)?(n="Stop",Tt+=4):n=o;n!==o&&(xt=e,n={type:Re.StopStatement});return e=n}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(lt),"DelVar "===t.substr(Tt,7)?(n="DelVar ",Tt+=7):n=o;n!==o?((r=te())===o&&(r=null),xt=e,u=r,e={type:Re.DelVarStatement,variable:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(st),"GraphStyle("===t.substr(Tt,11)?(n="GraphStyle(",Tt+=11):n=o;n!==o?((r=Ee())===o&&(r=null),(u=Le())===o&&(u=null),Xt(),xt=e,i=r,a=u,e={type:Re.GraphStyleStatement,equation:i,style:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(ft),"OpenLib("===t.substr(Tt,8)?(n="OpenLib(",Tt+=8):n=o;n!==o&&(r=qt())!==o?(Xt(),xt=e,u=r,e={type:Re.OpenLibStatement,name:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(pt),"ExecLib("===t.substr(Tt,8)?(n="ExecLib(",Tt+=8):n=o;n!==o&&(r=qt())!==o?(Xt(),xt=e,u=r,e={type:Re.ExecLibStatement,name:u}):(Tt=e,e=o);var u;return e}());return e}())===o&&(e=function(){var e;(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(dt),"Input "===t.substr(Tt,6)?(n="Input ",Tt+=6):n=o;n!==o?((r=function(){var e,n,r;e=Tt,(n=Ee())!==o?(!function(t){Ot(t)}($),44===t.charCodeAt(Tt)?(r=",",Tt++):r=o,r!==o?e=n:(Tt=e,e=o)):(Tt=e,e=o);return e}())===o&&(r=null),(u=te())===o&&(u=null),xt=e,e=function(t,e){return{type:Re.Input,text:t,variable:e}}(r,u)):(Tt=e,e=o);return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(mt),"Prompt "===t.substr(Tt,7)?(n="Prompt ",Tt+=7):n=o;n!==o?((r=te())===o&&(r=null),xt=e,u=r,e={type:Re.Prompt,variable:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(vt),"Disp "===t.substr(Tt,5)?(n="Disp ",Tt+=5):n=o;n!==o?((r=Ee())===o&&(r=null),xt=e,u=r,e={type:Re.Display,value:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(ht),"DispGraph"===t.substr(Tt,9)?(n="DispGraph",Tt+=9):n=o;n!==o&&(xt=e,n={type:Re.DispGraph});return e=n}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(St),"DispTable"===t.substr(Tt,9)?(n="DispTable",Tt+=9):n=o;n!==o&&(xt=e,n={type:Re.DispTable});return e=n}())===o&&(e=function(){var e,n,r,u,i;e=Tt,function(t){Ot(t)}(yt),"Output("===t.substr(Tt,7)?(n="Output(",Tt+=7):n=o;n!==o?((r=Ee())===o&&(r=null),(u=Le())===o&&(u=null),(i=Le())===o&&(i=null),Xt(),xt=e,a=r,c=u,l=i,e={type:Re.Output,row:a,column:c,value:l}):(Tt=e,e=o);var a,c,l;return e}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(bt),"ClrHome"===t.substr(Tt,7)?(n="ClrHome",Tt+=7):n=o;n!==o&&(xt=e,n={type:Re.ClrHome});return e=n}())===o&&(e=function(){var e,n;e=Tt,function(t){Ot(t)}(gt),"ClrTable"===t.substr(Tt,8)?(n="ClrTable",Tt+=8):n=o;n!==o&&(xt=e,n={type:Re.ClrTable});return e=n}())===o&&(e=function(){var e,n,r,u;e=Tt,function(t){Ot(t)}(Et),"GetCalc("===t.substr(Tt,8)?(n="GetCalc(",Tt+=8):n=o;n!==o?((r=te())===o&&(r=null),(u=Le())===o&&(u=null),Xt(),xt=e,i=r,a=u,e={type:Re.GetCalc,variable:i,portflag:a}):(Tt=e,e=o);var i,a;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(Lt),"Get("===t.substr(Tt,4)?(n="Get(",Tt+=4):n=o;n!==o?((r=te())===o&&(r=null),Xt(),xt=e,u=r,e={type:Re.Get,variable:u}):(Tt=e,e=o);var u;return e}())===o&&(e=function(){var e,n,r;e=Tt,function(t){Ot(t)}(Rt),"Send("===t.substr(Tt,5)?(n="Send(",Tt+=5):n=o;n!==o?((r=te())===o&&(r=null),Xt(),xt=e,u=r,e={type:Re.Send,variable:u}):(Tt=e,e=o);var u;return e}());return e}())===o&&(e=function(){var t,e;t=Tt,(e=Ee())!==o&&(xt=t,n=e,e={type:Re.ValueStatement,value:n});var n;return t=e}());return e}()}function Yt(){var e;return function(t){Ot(t)}(m),t.length>Tt?(e=t.charAt(Tt),Tt++):e=o,e}function jt(){var e;return function(t){Ot(t)}(v),c.test(t.charAt(Tt))?(e=t.charAt(Tt),Tt++):e=o,e}function Wt(){var e;return function(t){Ot(t)}(h),l.test(t.charAt(Tt))?(e=t.charAt(Tt),Tt++):e=o,e}function $t(){var e;return function(t){Ot(t)}(S),s.test(t.charAt(Tt))?(e=t.charAt(Tt),Tt++):e=o,e}function Kt(){var t,e,n;if(t=Tt,e=[],(n=Yt())!==o)for(;n!==o;)e.push(n),n=Yt();else e=o;return e!==o&&(xt=t,e=!0),t=e}function Xt(){var e;return function(t){Ot(t)}(y),41===t.charCodeAt(Tt)?(e=")",Tt++):e=o,e===o&&(e=null),e}function _t(){var t;return t=Tt,Wt()!==o?(Wt()===o&&null,xt=t,t=At()):(Tt=t,t=o),t}function qt(){var t;return t=Tt,jt()!==o?(Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,xt=t,t=At()):(Tt=t,t=o),t}function Qt(){var e,n;return e=Tt,function(t){Ot(t)}(R),"&list"===t.substr(Tt,5)?(n="&list",Tt+=5):n=o,n!==o&&jt()!==o?(Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,Wt()===o&&null,xt=e,e="List"+Ct().substring(5)):(Tt=e,e=o),e}function Zt(){var e,n,r;return e=Tt,(n=function(){var e,n;return(e=jt())===o&&(e=Tt,function(t){Ot(t)}(b),"&theta"===t.substr(Tt,6)?(n="&theta",Tt+=6):n=o,n!==o&&(xt=e,n="THETA"),e=n),e}())!==o&&(xt=e,r=n,n={type:Re.VARIABLE,name:r}),e=n}function zt(){var e,n,r;return e=Tt,(n=function(){var e,n;return e=Tt,function(t){Ot(t)}(g),"Str"===t.substr(Tt,3)?(n="Str",Tt+=3):n=o,n!==o&&$t()!==o?(xt=e,e=At()):(Tt=e,e=o),e}())!==o&&(xt=e,r=n,n={type:Re.STRINGVARIABLE,name:r}),e=n}function Jt(){var e,n,r;return e=Tt,(n=function(){var e,n,r,u=function(t){Ot(t)};return e=Tt,u(E),"&L"===t.substr(Tt,2)?(n="&L",Tt+=2):n=o,n!==o?(u(L),f.test(t.charAt(Tt))?(r=t.charAt(Tt),Tt++):r=o,r!==o?(xt=e,e="List"+r):(Tt=e,e=o)):(Tt=e,e=o),e}())!==o&&(xt=e,r=n,n={type:Re.LISTVARIABLE,name:r,custom:!1}),(e=n)===o&&(e=Tt,(n=Qt())!==o&&(xt=e,n=function(t){return{type:Re.LISTVARIABLE,name:t,custom:!0}}(n)),e=n),e}function te(){var t;return(t=zt())===o&&(t=Zt())===o&&(t=Jt()),t}function ee(){var e,n,r,u,i,a;return e=Tt,(n=Jt())!==o?(!function(t){Ot(t)}(A),40===t.charCodeAt(Tt)?(r="(",Tt++):r=o,r!==o&&(u=Ee())!==o?(Xt(),xt=e,i=n,a=u,e={type:Re.LISTINDEX,list:i,index:a}):(Tt=e,e=o)):(Tt=e,e=o),e}function ne(){var t;return(t=ee())===o&&(t=te()),t}function re(){var e,n,r;if(e=Tt,n=[],(r=$t())!==o)for(;r!==o;)n.push(r),r=$t();else n=o;return e=n!==o?t.substring(e,Tt):n}function ue(){var e,n,r;return e=Tt,function(){var e;return function(t){Ot(t)}(w),"&E"===t.substr(Tt,2)?(e="&E",Tt+=2):e=o,e}()!==o?(n=Tt,r=function(){var e,n,r,u;return e=Tt,n=Tt,function(t){Ot(t)}(I),p.test(t.charAt(Tt))?(r=t.charAt(Tt),Tt++):r=o,r===o&&(r=null),(u=re())!==o?n=r=[r,u]:(Tt=n,n=o),e=n!==o?t.substring(e,Tt):n}(),(n=r!==o?t.substring(n,Tt):r)!==o?e=n:(Tt=e,e=o)):(Tt=e,e=o),e}function oe(){var e,n,r,u,i,a,c,l,s=function(t){Ot(t)};return e=Tt,(n=re())!==o?(s(k),46===t.charCodeAt(Tt)?(r=".",Tt++):r=o,r!==o?((u=re())===o&&(u=null),(i=ue())===o&&(i=null),xt=e,a=n,c=u,l=i,e={type:Re.NUMBER,integer:a,fraction:c,exponent:l}):(Tt=e,e=o)):(Tt=e,e=o),e===o&&(e=Tt,s(k),46===t.charCodeAt(Tt)?(n=".",Tt++):n=o,n!==o&&(r=re())!==o?((u=ue())===o&&(u=null),xt=e,e=function(t,e){return{type:Re.NUMBER,fraction:t,exponent:e}}(r,u)):(Tt=e,e=o),e===o&&(e=Tt,(n=re())!==o?((r=ue())===o&&(r=null),xt=e,e=function(t,e){return{type:Re.NUMBER,integer:t,exponent:e}}(n,r)):(Tt=e,e=o))),e}function ie(){var e;return function(t){Ot(t)}(T),d.test(t.charAt(Tt))?(e=t.charAt(Tt),Tt++):e=o,e}function ae(){var e,n,r,u,i,a=function(t){Ot(t)};return e=Tt,a(x),34===t.charCodeAt(Tt)?(n='"',Tt++):n=o,n!==o?(r=function(){var e,n,r;for(e=Tt,n=[],r=ie();r!==o;)n.push(r),r=ie();return e=t.substring(e,Tt)}(),a(x),34===t.charCodeAt(Tt)?(u='"',Tt++):u=o,u===o&&(u=null),xt=e,i=r,e={type:Re.STRING,chars:i}):(Tt=e,e=o),e}function ce(){var e,n;return e=Tt,function(t){Ot(t)}(N),"Ans"===t.substr(Tt,3)?(n="Ans",Tt+=3):n=o,n!==o&&(xt=e,n={type:Re.ANS}),e=n}function le(){var e,n;return e=Tt,function(t){Ot(t)}(B),"getKey"===t.substr(Tt,6)?(n="getKey",Tt+=6):n=o,n!==o&&(xt=e,n={type:Re.GetKey}),e=n}function se(){var t;return(t=function(){var t;return(t=ce())===o&&(t=le()),t}())===o&&(t=ne())===o&&(t=ae()),t}function fe(){var e,n,r,u,i,a,c,l=function(t){Ot(t)};if(e=Tt,l(C),123===t.charCodeAt(Tt)?(n="{",Tt++):n=o,n!==o)if((r=Ee())!==o){for(u=[],i=Le();i!==o;)u.push(i),i=Le();l(G),125===t.charCodeAt(Tt)?(i="}",Tt++):i=o,i===o&&(i=null),xt=e,a=r,c=u,e=Ae.buildList(a,c)}else Tt=e,e=o;else Tt=e,e=o;return e}function pe(){var e;return function(t){Ot(t)}(M),"&-"===t.substr(Tt,2)?(e="&-",Tt+=2):e=o,e}function de(){var e,n,r;return(e=function(){var e,n,r,u,i=function(t){Ot(t)};return(e=se())===o&&(e=Tt,i(A),40===t.charCodeAt(Tt)?(n="(",Tt++):n=o,n!==o&&(r=Ee())!==o?(i(y),41===t.charCodeAt(Tt)?(u=")",Tt++):u=o,u!==o?e=r:(Tt=e,e=o)):(Tt=e,e=o),e===o&&(e=fe())),e}())===o&&(e=Tt,(n=pe())!==o&&(r=de())!==o?(xt=e,e=It(n,r)):(Tt=e,e=o)),e}function me(){var t,e,n;return(t=de())===o&&(t=oe())===o&&(t=Tt,(e=pe())!==o&&(n=me())!==o?(xt=t,t=It(e,n)):(Tt=t,t=o)),t}function ve(){var t,e,n,r,u,i;if(t=Tt,(e=de())!==o){for(n=[],r=Tt,(u=me())!==o&&(i=de())!==o?r=u=[u,i]:(Tt=r,r=o);r!==o;)n.push(r),r=Tt,(u=me())!==o&&(i=de())!==o?r=u=[u,i]:(Tt=r,r=o);(r=me())===o&&(r=null),xt=t,t=wt(e,n,r)}else Tt=t,t=o;if(t===o){if(t=Tt,(e=me())!==o){for(n=[],r=Tt,(u=de())!==o&&(i=me())!==o?r=u=[u,i]:(Tt=r,r=o);r!==o;)n.push(r),r=Tt,(u=de())!==o&&(i=me())!==o?r=u=[u,i]:(Tt=r,r=o);(r=de())===o&&(r=null),xt=t,t=wt(e,n,r)}else Tt=t,t=o;t===o&&(t=me())}return t}function he(){var e,n=function(t){Ot(t)};return n(D),42===t.charCodeAt(Tt)?(e="*",Tt++):e=o,e===o&&(n(V),47===t.charCodeAt(Tt)?(e="/",Tt++):e=o),e}function Se(){var t,e,n,r,u,i;if(t=Tt,(e=ve())!==o){for(n=[],r=Tt,(u=he())!==o&&(i=ve())!==o?r=u=[u,i]:(Tt=r,r=o);r!==o;)n.push(r),r=Tt,(u=he())!==o&&(i=ve())!==o?r=u=[u,i]:(Tt=r,r=o);xt=t,t=kt(e,n)}else Tt=t,t=o;return t}function ye(){var e,n=function(t){Ot(t)};return n(U),43===t.charCodeAt(Tt)?(e="+",Tt++):e=o,e===o&&(n(P),45===t.charCodeAt(Tt)?(e="-",Tt++):e=o),e}function be(){var t,e,n,r,u,i;if(t=Tt,(e=Se())!==o){for(n=[],r=Tt,(u=ye())!==o&&(i=Se())!==o?r=u=[u,i]:(Tt=r,r=o);r!==o;)n.push(r),r=Tt,(u=ye())!==o&&(i=Se())!==o?r=u=[u,i]:(Tt=r,r=o);xt=t,t=kt(e,n)}else Tt=t,t=o;return t}function ge(){var e,n=function(t){Ot(t)};return n(O),61===t.charCodeAt(Tt)?(e="=",Tt++):e=o,e===o&&(n(F),"!="===t.substr(Tt,2)?(e="!=",Tt+=2):e=o,e===o&&(n(H),">="===t.substr(Tt,2)?(e=">=",Tt+=2):e=o,e===o&&(n(Y),62===t.charCodeAt(Tt)?(e=">",Tt++):e=o,e===o&&(n(j),"<="===t.substr(Tt,2)?(e="<=",Tt+=2):e=o,e===o&&(n(W),60===t.charCodeAt(Tt)?(e="<",Tt++):e=o))))),e}function Ee(){var t,e,n,r,u,i;if(t=Tt,(e=be())!==o){for(n=[],r=Tt,(u=ge())!==o&&(i=be())!==o?r=u=[u,i]:(Tt=r,r=o);r!==o;)n.push(r),r=Tt,(u=ge())!==o&&(i=be())!==o?r=u=[u,i]:(Tt=r,r=o);xt=t,t=kt(e,n)}else Tt=t,t=o;return t}function Le(){var e,n,r;return e=Tt,function(t){Ot(t)}($),44===t.charCodeAt(Tt)?(n=",",Tt++):n=o,n!==o&&(r=Ee())!==o?e=r:(Tt=e,e=o),e}const Re=n(0),Ae=n(2);if(Pt(),(u=a())!==o&&Tt===t.length)return u;throw u!==o&&Tt<t.length&&Ot({type:"end"}),function(){var e=Bt[0],n=e.pos;return Ft(e.variants,n<t.length?t.charAt(n):null,n<t.length?Ut(n,n+1):Ut(n,n))}()}}},function(t,e,n){"use strict";n.r(e),n.d(e,"buildBinaryExpression",(function(){return u})),n.d(e,"buildImplicitBinaryExpression",(function(){return o})),n.d(e,"buildMenuStatement",(function(){return i})),n.d(e,"buildList",(function(){return a}));var r=n(0);function u(t,e){return e.reduce((function(t,e){return{type:r.BINARY,operator:e[0],left:t,right:e[1]}}),t)}function o(t,e,n){const u=e.flat();return null!==n&&u.push(n),u.reduce((function(t,e){return{type:r.BINARY,operator:"*",left:t,right:e}}),t)}function i(t,e){const n=e.map((function(t){return{option:t[1],location:t[3]}}));return{type:r.MenuStatement,title:t,choices:n}}function a(t,e){return{type:r.LIST,elements:[t].concat(e)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"run",(function(){return tt})),n.d(e,"on",(function(){return J})),n.d(e,"parse",(function(){return L})),n.d(e,"exec",(function(){return et}));var r=n(0);function u(t,e,n=!1){return{type:t,code:e,hideSource:n}}function o(t,e=!1){return u(r.ti,t,e)}const i=o("DATA TYPE"),a=o("SYNTAX"),c=o("UNDEFINED"),l=o("LABEL"),s=o("ARGUMENT"),f=o("DIM MISMATCH"),p=o("DIVIDE BY 0"),d=o("INVALID DIM"),m=o("DOMAIN");function v(t,e=!1){return u(r.lib,t,e)}const h=v("unimplemented");function S(t=0){return{type:r.NUMBER,float:t}}const y=S(1),b=S(-1);var g=n(1),E=n.n(g);function L(t,e={}){if(void 0===t)throw new Error("Undefined source!");const n=e.sourceMap||"inline";return t.split(/\r?\n/).map(t=>{let e;try{e=E.a.parse(t)}catch(t){if("SyntaxError"!==t.name)throw t;e={type:"SyntaxError"}}return"inline"===n&&(e.source=t),e})}function R(t){if(t.type===r.NUMBER)return 0!==t.float;throw i}function A(t,e,n){if(e.type===r.STRINGVARIABLE){if(n.type!==r.STRING)throw i}else if(e.type===r.VARIABLE){if(n.type!==r.NUMBER)return}else if(e.type===r.LISTVARIABLE){if(n.type!==r.LIST)throw i}else{if(e.type!==r.LISTINDEX)throw v("unexpected variable type");if(n.type!==r.LIST)throw i}t.vars[e.name]=n}function I(t,e){t.ans=e}function w(t,e,n){return{type:r.BINARY,operator:e,left:t,right:n}}function k(t){let e="";return void 0!==t.integer&&null!==t.integer&&(e+=t.integer),void 0!==t.fraction&&null!==t.fraction&&(e+="."+t.fraction),void 0!==t.exponent&&null!==t.exponent&&(e+="e"+t.exponent),parseFloat(e)}function T(t,e=!1){if(e&&t.type!==r.STRING)throw i;let n="";switch(t.type){case r.NUMBER:n=t.float.toString(),n.startsWith("0.")&&(n=n.substring(1));break;case r.STRING:n=t.chars;break;case r.LIST:n="{"+t.elements.map(t=>T(t)).join(" ")+"}";break;default:throw v("unexpected value tostring")}return n}function x(t,e){const n=N[t.type];if(void 0===n)throw v("unexpected value");return n(t,e)}const N={};N[r.SyntaxError]=(t,e)=>{throw a},N[r.NUMBER]=(t,e)=>void 0!==t.float?t:{type:r.NUMBER,float:k(t)},N[r.STRING]=(t,e)=>t,N[r.LIST]=(t,e)=>!0===t.resolved?t:{type:r.LIST,elements:t.elements.map((function(t){const n=x(t,e);if(n.type!==r.NUMBER)throw i;return n})),resolved:!0},N[r.VARIABLE]=(t,e)=>{let n=e.vars[t.name];return void 0===n&&(n=e.vars[t.name]=S()),n},N[r.STRINGVARIABLE]=(t,e)=>{const n=e.vars[t.name];if(void 0===n)throw c;return n},N[r.LISTVARIABLE]=(t,e)=>{const n=e.vars[t.name];if(void 0===n)throw c;return n},N[r.LISTINDEX]=(t,e)=>{const n=x(t.list,e),u=x(t.index,e);if(u.type!==r.NUMBER)throw d;if(u.float<1||u.float>n.elements.length)throw d;return{type:r.NUMBER,float:n.elements[u.float-1].float}},N[r.ANS]=(t,e)=>e.ans,N[r.GetKey]=(t,e)=>{throw h},N[r.UNARY]=(t,e)=>{const n=x(t.argument,e),r=B[n.type];if(void 0===r)throw v("unexpected unary argument");return r(t.operator,n)},N[r.BINARY]=(t,e)=>{const n=x(t.left,e),r=x(t.right,e),u=C[n.type];if(void 0===u)throw v("unexpected binary left");return u(t.operator,n,r)};const B={};B[r.NUMBER]=(t,e)=>({type:r.NUMBER,float:M(t,e.float)}),B[r.STRING]=(t,e)=>{throw i},B[r.LIST]=(t,e)=>({type:r.LIST,elements:e.elements.map(e=>({type:r.NUMBER,float:M(t,e.float)})),resolved:!0});const C={};function G(t,e,n){return{type:r.LIST,elements:e.elements.map((e,u)=>({type:r.NUMBER,float:D(t,e.float,n.float)})),resolved:!0}}function M(t,e){switch(t){case"&-":return-1*e;default:throw v("unexpected unary operator")}}function D(t,e,n){if("/"===t&&0===n)throw p;switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"=":return e===n?1:0;case"!=":return e!==n?1:0;case">=":return e>=n?1:0;case">":return e>n?1:0;case"<=":return e<=n?1:0;case"<":return e<n?1:0;default:throw v("unexpected binary operator")}}C[r.NUMBER]=(t,e,n)=>{if(n.type!==r.NUMBER){if(n.type===r.LIST)return G(t,n,e);throw i}return{type:r.NUMBER,float:D(t,e.float,n.float)}},C[r.STRING]=(t,e,n)=>{if(n.type!==r.STRING)throw i;if(["+"].includes(t))return{type:r.STRING,chars:D(t,e.chars,n.chars)};if(["=","!="].includes(t))return{type:r.NUMBER,float:D(t,e.chars,n.chars)};throw i},C[r.LIST]=(t,e,n)=>{if(n.type!==r.LIST){if(n.type===r.NUMBER)return G(t,e,n);throw i}if(e.elements.length!==n.elements.length)throw f;return{type:r.LIST,elements:e.elements.map((e,u)=>({type:r.NUMBER,float:D(t,e.float,n.elements[u].float)})),resolved:!0}};const V={};V[r.VARIABLE]=(t,e,n)=>{e.type===r.NUMBER&&(n.vars[t.name]=e)},V[r.STRINGVARIABLE]=(t,e,n)=>{if(e.type!==r.STRING)throw i;n.vars[t.name]=e},V[r.LISTVARIABLE]=(t,e,n)=>{if(e.type!==r.LIST)throw i;n.vars[t.name]=e},V[r.LISTINDEX]=(t,e,n)=>{const u=x(t.list,n),o=x(t.index,n);if(o.type!==r.NUMBER)throw i;if(o.float<1||o.float>u.elements.length)throw d;n.vars[t.list.name].elements[o.float-1]=e};function U(t,e={},n=!0){void 0!==e.output?e.output(t,n):console.log(t)}function P(t,e={}){void 0!==e.stdin&&""!==e.stdin&&void 0===e.stdinQueue&&(e.stdinQueue=e.stdin.split("\n").reverse()),void 0===e.stdinQueue?void 0!==e.input?(setTimeout(()=>e.input.val(""),0),e.input.on("keypress",n=>{if(13===n.keyCode){const n=e.input.val();setTimeout(()=>e.input.val(""),0),!0!==t(n)&&e.input.off("keypress")}})):setTimeout(()=>{!0===t(prompt("Input?"))&&P(t,e)},100):setTimeout(()=>{const n=e.stdinQueue.pop();!0===t(n)&&P(t,e)},0)}const O={};function F(t,e,n){if(!function(t,e){return e.name in t.vars}(t,e))throw c;A(t,e,x({type:r.BINARY,operator:"+",left:e,right:n},t))}function H(t,e,n,u){return U(t,n.io,!1),P(t=>{if(null==t||""===t)return!0;n.resume(()=>{let o;U(t,n.io),o=e.type===r.STRINGVARIABLE&&u?{type:r.STRING,chars:t}:x(function(t){if(void 0===t)throw new Error("Undefined source!");const e=t.split(/\r?\n/);if(e.Length>1)throw new Error("Too many lines for an expression");const n=e[0];let u;try{u=E.a.parse(n)}catch(t){if("SyntaxError"!==t.name)throw t}return void 0!==u&&u.type===r.ValueStatement?u.value:{type:"SyntaxError"}}(t),n.mem),e.type===r.VARIABLE&&o.type===r.LIST&&(e={type:r.LISTVARIABLE,name:"List"+e.name,custom:!0}),A(n.mem,e,o)})},n.io),"suspend"}O[r.EmptyStatement]=(t,e)=>{},O[r.AssignmentStatement]=(t,e)=>{const n=x(t.value,e.mem);!function(t,e,n){const r=V[t.type];if(void 0===r)throw v("unexpected assignable type");r(t,e,n)}(t.assignable,n,e.mem),I(e.mem,n)},O[r.ValueStatement]=(t,e)=>{I(e.mem,x(t.value,e.mem))},O[r.SyntaxError]=(t,e)=>{throw a},O[r.IfStatement]=(t,e)=>{if(null===t.value)throw s;e.ifResult=R(x(t.value,e.mem))},O[r.ThenStatement]=(t,e)=>{throw a},O[r.ElseStatement]=(t,e)=>{if(0===e.blockStack.length)throw a;if(e.lines[e.blockStack.pop()].type!==r.ThenStatement)throw a;e.blockStack.push(e.i),e.falsyStackHeight=e.blockStack.length},O[r.ForLoop]=(t,e)=>{if(null===t.variable||null===t.start||null===t.end)throw s;A(e.mem,t.variable,x(t.start,e.mem)),e.blockStack.push(e.i),R(x(w(t.variable,"<=",t.end),e.mem))||(e.falsyStackHeight=e.blockStack.length)},O[r.WhileLoop]=(t,e)=>{if(null===t.value)throw s;e.blockStack.push(e.i),R(x(t.value,e.mem))||(e.falsyStackHeight=e.blockStack.length)},O[r.RepeatLoop]=(t,e)=>{if(null===t.value)throw s;e.blockStack.push(e.i)},O[r.EndStatement]=(t,e)=>{if(0===e.blockStack.length)throw a;const n=e.blockStack.pop(),u=e.lines[n];if(u.type===r.ForLoop||u.type===r.WhileLoop||u.type===r.RepeatLoop)u.type===r.ForLoop?(F(e.mem,u.variable,null!==u.step?u.step:y),R(x(w(u.variable,"<=",u.end),e.mem))&&(e.blockStack.push(n),e.i=n)):R(x(u.value,e.mem))&&(e.blockStack.push(n),e.i=n);else if(u.type!==r.ThenStatement&&u.type!==r.ElseStatement)throw v("impossibleEndFrom'"+u.type)},O[r.PauseStatement]=(t,e)=>{throw h},O[r.LabelStatement]=(t,e)=>{},O[r.GotoStatement]=(t,e)=>{e.searchLabel=t.location,e.i=-1},O[r.IncrementSkip]=(t,e)=>{if(null===t.variable||null===t.end)throw s;F(e.mem,t.variable,y),e.incrementDecrementResult=R(x(w(t.variable,"<=",t.end),e.mem))},O[r.DecrementSkip]=(t,e)=>{if(null===t.variable||null===t.end)throw s;F(e.mem,t.variable,b),e.incrementDecrementResult=R(x(w(t.variable,">=",t.end),e.mem))},O[r.MenuStatement]=(t,e)=>{if(null===t.title||0===t.choices.length||t.choices.length>7)throw s;return U(T(x(t.title,e.mem),!0),e.io),t.choices.forEach((t,n)=>{U(`${n+1}:${T(t.option)}`,e.io)}),P(n=>{const r=function(t){if(null==t||""===t||t.length>1)return;const e=t.charCodeAt(0)-"0".charCodeAt(0);return e<0||e>9?void 0:e}(n);if(void 0===r||0===r||r>t.choices.length)return!0;e.searchLabel=t.choices[r-1].location,e.i=0,e.resume()},e.io),"suspend"},O[r.ProgramStatement]=(t,e)=>{throw h},O[r.ReturnStatement]=(t,e)=>"done",O[r.StopStatement]=(t,e)=>"done",O[r.DelVarStatement]=(t,e)=>{if(null===t.variable)throw s;var n,r;n=e.mem,r=t.variable,delete n.vars[r.name]},O[r.GraphStyleStatement]=(t,e)=>{throw h},O[r.OpenLibStatement]=(t,e)=>{throw h},O[r.ExecLibStatement]=(t,e)=>{throw h},O[r.Display]=(t,e)=>{null!==t.value&&U(T(x(t.value,e.mem)),e.io)},O[r.Input]=(t,e)=>{if(null===t.variable){if(null!==t.text)throw s;throw h}let n="?";return null!==t.text&&(n=T(x(t.text,e.mem),!0)),H(n,t.variable,e,!0)},O[r.Prompt]=(t,e)=>{if(null===t.variable)throw s;return H(function(t){let e=t.name;switch(t.type){case r.VARIABLE:case r.STRINGVARIABLE:break;case r.LISTVARIABLE:e=e.substring(4),t.custom||(e="&L"+e);break;default:throw v("unexpected variable tostring")}return e}(t.variable)+"=?",t.variable,e,!1)},O[r.DispGraph]=(t,e)=>{throw h},O[r.DispTable]=(t,e)=>{throw h},O[r.Output]=(t,e)=>{if(null===t.row||null===t.column||null===t.value)throw s;const n=x(t.row,e.mem),u=x(t.column,e.mem);if(n.type!==r.NUMBER||u.type!==r.NUMBER)throw i;if(n.float<1||n.float>e.rows||u.float<1||u.float>e.columns)throw m;U(T(x(t.value,e.mem)),e.io)},O[r.ClrHome]=(t,e)=>{throw h},O[r.ClrTable]=(t,e)=>{throw h},O[r.GetCalc]=(t,e)=>{throw h},O[r.Get]=(t,e)=>{throw h},O[r.Send]=(t,e)=>{throw h};const Y={},j=[];let W=!1,$=0;const K=document.createTextNode(null);function X(t){const e=new Event(t);K.dispatchEvent(e)}function _(){!1===W&&(W=!0,X("start"),window.postMessage("daemon-loop","*"))}function q(t,e,n){const r=$++;return console.debug(`[Task ${r}] Start`),Y[r]={func:t,delay:Math.max(e,.001),lastRun:void 0,runOnce:n,stopOnException:!0,suspended:!1},_(),r}function Q(t){if(console.debug(`[Task ${t}] Suspend`),!(t in Y))throw new Error(`Error suspending: task '${t}' not found`);Y[t].suspended=!0}function Z(t){console.debug(`[Task ${t}] Stop`),delete Y[t]}function z(t){!function(t){if(console.debug(`[Task ${t}] Resume`),!(t in Y))throw console.debug(Y),new Error(`Error resuming: task '${t}' not found`);Y[t].suspended=!1,_()}(t)}window.addEventListener("message",(function(t){if(t.source!==window||"daemon-loop"!==t.data)return;t.stopPropagation();const e=performance.now(),n=Object.keys(Y);let r=0,u=0;n.forEach(t=>{const n=Y[t];let o;if(!0===n.suspended)o=0,u+=1;else if(r+=1,void 0===n.lastRun||n.runOnce)o=1;else{const t=e-n.lastRun;o=Math.floor(t/n.delay)}o>0&&(n.lastRun=e);for(let e=0;e<o;e++){let e;try{e=n.func()}catch(t){e="faulted",j.length<1e3&&(j.push(t),window.postMessage("daemon-exception","*"))}if("done"===e||n.runOnce||n.stopOnException&&"faulted"===e){Z(t),r-=1;break}if("suspend"===e){Q(t),r-=1,u+=1;break}if("yield"===e)break}}),0===r?(W=!1,X(u>0?"suspend":"stop")):window.postMessage("daemon-loop","*")}),!0),window.addEventListener("message",(function(t){if(t.source===window&&"daemon-exception"===t.data&&j.length>0)throw j.pop()}),!0);const J=K.addEventListener.bind(K);K.removeEventListener.bind(K);function tt(t,e={}){let n=[];void 0!==e.source&&(n=Array.isArray(e.source)?e.source:e.source.split(/\r?\n/));let u=1;void 0!==e.frequencyMs&&(u=e.frequencyMs);let o=e.outputCallback;var i;void 0!==e.elem&&(i=e.elem,o=(t,e)=>{setTimeout(()=>{let n=i.val()+t;e&&(n+="\n"),i.val(n)},0)});const c={mem:{vars:{},ans:S()},resume:void 0,resumeCallback:void 0,debug:!0===e.debug,sourceLines:n,searchLabel:void 0,ifResult:void 0,incrementDecrementResult:void 0,maximumLines:50,linesRun:0,blockStack:[],falsyStackHeight:void 0,falsyBlockPreviousIf:void 0,i:0,lines:t,callback:e.callback,frequencyMs:u,status:"pending",rows:8,columns:16,io:{output:o,input:e.input,stdin:e.stdin,includeErrors:void 0===e.includeErrors||!0===e.includeErrors,includeLibErrors:void 0===e.includeLibErrors||!0===e.includeLibErrors,includeLineNumbers:void 0===e.includeLineNumbers||!0===e.includeLineNumbers,includeSource:void 0===e.includeSource||!0===e.includeSource}},f=(p=()=>function(t){let e;try{t.status="running",e=function(t){if(t.debug&&console.debug({Line:t.i,searchLabel:t.searchLabel,ifResult:t.ifResult,blockStack:t.blockStack,falsyStackHeight:t.falsyStackHeight,falsyBlockPreviousIf:t.falsyBlockPreviousIf,source:t.source,mem:t.mem}),void 0!==t.resumeCallback&&(t.resumeCallback(),t.resumeCallback=void 0),t.i>=t.lines.length){if(void 0!==t.searchLabel)throw l;if(void 0!==t.ifResult||void 0!==t.incrementDecrementResult)throw a;return t.debug&&console.debug(t.mem),"done"}if(t.linesRun++,t.linesRun>=t.maximumLines)throw v("maxlines");const e=t.lines[t.i],n=e.type;if(void 0!==t.falsyStackHeight){const e=t.blockStack[t.blockStack.length-1],u=t.lines[e];return(n===r.EndStatement||n===r.ElseStatement&&u.type===r.ThenStatement)&&(t.blockStack.pop(),t.blockStack.length<t.falsyStackHeight&&(t.falsyStackHeight=void 0)),(n===r.ForLoop||n===r.RepeatLoop||n===r.WhileLoop||n===r.ThenStatement&&!0===t.falsyBlockPreviousIf||n===r.ElseStatement&&u.type===r.ThenStatement)&&t.blockStack.push(t.i),void(t.falsyBlockPreviousIf=n===r.IfStatement)}if(t.falsyBlockPreviousIf=void 0,void 0===t.searchLabel){if(void 0!==t.ifResult){const e=!0!==t.ifResult;if(t.ifResult=void 0,n===r.ThenStatement)return t.blockStack.push(t.i),void(e&&(t.falsyStackHeight=t.blockStack.length));if(e)return}if(void 0!==t.incrementDecrementResult){const e=!0!==t.incrementDecrementResult;if(t.incrementDecrementResult=void 0,e)return}if(!0===e.extra)throw a;if(!0===e.args)throw s;return function(t,e){const n=O[t.type];if(void 0===n)throw v("unexpected");return n(t,e)}(e,t)}n===r.LabelStatement&&e.location===t.searchLabel&&(t.searchLabel=void 0)}(t)}catch(n){if(t.status="faulted",void 0===n.type)throw n;if(t.i<t.lines.length&&!0!==n.hideSource){let e=t.lines[t.i].source;void 0!==t.sourceLines&&(e=t.sourceLines[t.i]),n.source={index:t.i,line:e}}!function(t,e={}){if(t.type===r.ti&&!e.includeErrors||t.type===r.lib&&!e.includeLibErrors)return void console.log(t);let n="";t.type===r.ti?n+="ERR:":t.type===r.lib?n+="Error: ":n+="Unexpected: ",n+=t.code,e.includeLineNumbers&&void 0!==t.source&&void 0!==t.source.index&&(n+=" on line "+t.source.index),e.includeSource&&void 0!==t.source&&void 0!==t.source.line&&(n+=" :"+t.source.line),U(n,e)}(n,t.io),e="done"}return"done"===e?("faulted"!==t.status&&(t.status="done"),void 0!==t.callback&&setTimeout(t.callback,0)):t.i+=1,e}(c),d=c.frequencyMs,q(p,d));var p,d;return c.resume=t=>{c.resumeCallback=t,z(f)},{getStatus:()=>c.status,isActive:()=>"pending"===c.status||"running"===c.status,stop:()=>{!function(t={}){void 0!==t.input&&t.input.off("keypress")}(c.io),Z(f)}}}function et(t,e){const n=ti.parse(t);ti.run(n,{outputCallback:e})}}]);
//# sourceMappingURL=ti.js.map